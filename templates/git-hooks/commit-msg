#!/bin/bash
# AI开发规范 - Commit message检查
# 确保提交信息符合规范格式

COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat $COMMIT_MSG_FILE)

# 颜色定义
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

print_error() {
    echo -e "${RED}❌ $1${NC}"
}

print_success() {
    echo -e "${GREEN}✅ $1${NC}"
}

# 检查提交信息格式
if [[ $COMMIT_MSG =~ ^(feat|fix|docs|style|refactor|test|chore|agent)(\(.+\))?\:.+ ]]; then
    print_success "提交信息格式正确"
    exit 0
fi

# 如果格式不正确，给出建议
print_error "提交信息格式不规范"
echo ""
echo "正确格式: <类型>[可选范围]: <描述>"
echo ""
echo "类型说明:"
echo "  feat     - 新功能"
echo "  fix      - Bug修复"  
echo "  docs     - 文档更新"
echo "  style    - 代码格式调整"
echo "  refactor - 重构"
echo "  test     - 测试相关"
echo "  chore    - 构建/工具相关"
echo "  agent    - Agent相关更新"
echo ""
echo "示例:"
echo "  feat: 添加用户登录功能"
echo "  fix(auth): 修复登录验证问题"
echo "  docs: 更新API文档"
echo "  agent: 优化对话流程设计"
echo ""
echo "当前提交信息:"
echo "  $COMMIT_MSG"

exit 1