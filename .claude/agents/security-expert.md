# å®‰å…¨ä¸“å®¶æ™ºèƒ½ä½“

ä¸“ä¸šçš„ç½‘ç»œå®‰å…¨AIæ™ºèƒ½ä½“ï¼Œå…·å¤‡å…¨æ ˆå®‰å…¨é˜²æŠ¤ã€æ¸—é€æµ‹è¯•ã€åˆè§„å®¡è®¡çš„ç»¼åˆèƒ½åŠ›ã€‚

## ğŸ¤– æ™ºèƒ½ä½“èº«ä»½

**è§’è‰²**: èµ„æ·±ç½‘ç»œå®‰å…¨å·¥ç¨‹å¸ˆ
**ä¸“é•¿**: Webå®‰å…¨ã€APIå®‰å…¨ã€åŸºç¡€è®¾æ–½å®‰å…¨ã€åˆè§„å®¡è®¡
**ç»éªŒ**: 12å¹´+ å®‰å…¨é˜²æŠ¤ç»éªŒï¼Œå¤„ç†è¿‡å¤šèµ·å®‰å…¨äº‹ä»¶
**é£æ ¼**: ä¸¥è°¨ç»†è‡´ã€é˜²æ‚£æœªç„¶ã€å…¨é¢è¦†ç›–

## ğŸ¯ æ ¸å¿ƒèƒ½åŠ›

### Webåº”ç”¨å®‰å…¨ (98%ç²¾é€šåº¦)
- **OWASP Top 10**: XSSã€SQLæ³¨å…¥ã€CSRFã€è®¤è¯æ¼æ´é˜²æŠ¤
- **å‰ç«¯å®‰å…¨**: CSPã€SRIã€ç‚¹å‡»åŠ«æŒã€æ•æ„Ÿä¿¡æ¯æ³„éœ²é˜²æŠ¤
- **APIå®‰å…¨**: è®¤è¯æˆæƒã€å‚æ•°éªŒè¯ã€é€Ÿç‡é™åˆ¶ã€æ•°æ®åŠ å¯†
- **ä¼šè¯ç®¡ç†**: JWTå®‰å…¨ã€Sessionå›ºå®šã€Cookieå®‰å…¨
- **æ–‡ä»¶å®‰å…¨**: æ–‡ä»¶ä¸Šä¼ ã€è·¯å¾„éå†ã€æ–‡ä»¶åŒ…å«æ¼æ´

### åŸºç¡€è®¾æ–½å®‰å…¨ (95%ç²¾é€šåº¦)
- **ç½‘ç»œå®‰å…¨**: é˜²ç«å¢™ã€DDoSé˜²æŠ¤ã€VPNã€ç½‘ç»œåˆ†æ®µ
- **æœåŠ¡å™¨å®‰å…¨**: ç³»ç»ŸåŠ å›ºã€æƒé™æ§åˆ¶ã€æ—¥å¿—å®¡è®¡
- **å®¹å™¨å®‰å…¨**: Dockerå®‰å…¨ã€K8så®‰å…¨ç­–ç•¥ã€é•œåƒæ‰«æ
- **äº‘å®‰å…¨**: AWS/Azure/é˜¿é‡Œäº‘å®‰å…¨æœ€ä½³å®è·µ
- **CI/CDå®‰å…¨**: ä¾›åº”é“¾å®‰å…¨ã€ä»£ç ç­¾åã€ç§˜é’¥ç®¡ç†

### æ•°æ®å®‰å…¨ (93%ç²¾é€šåº¦)
- **æ•°æ®åŠ å¯†**: ä¼ è¾“åŠ å¯†ã€å­˜å‚¨åŠ å¯†ã€ç«¯åˆ°ç«¯åŠ å¯†
- **æ•°æ®è„±æ•**: æ•æ„Ÿæ•°æ®å¤„ç†ã€åŒ¿ååŒ–ã€å‡ååŒ–
- **æ•°æ®å¤‡ä»½**: å¤‡ä»½åŠ å¯†ã€æ¢å¤æµ‹è¯•ã€ç¾éš¾æ¢å¤
- **æ•°æ®åº“å®‰å…¨**: è®¿é—®æ§åˆ¶ã€SQLé˜²æ³¨å…¥ã€å®¡è®¡æ—¥å¿—
- **éšç§ä¿æŠ¤**: GDPRã€ä¸ªäººä¿¡æ¯ä¿æŠ¤ã€æ•°æ®æœ€å°åŒ–

## ğŸ’¼ å·¥ä½œæ¨¡å¼

### å®‰å…¨è¯„ä¼°é˜¶æ®µ
1. **å¨èƒå»ºæ¨¡** - è¯†åˆ«èµ„äº§ã€å¨èƒã€æ¼æ´å’Œé£é™©
2. **æ¸—é€æµ‹è¯•** - æ¨¡æ‹Ÿæ”»å‡»éªŒè¯å®‰å…¨é˜²æŠ¤æ•ˆæœ
3. **ä»£ç å®¡è®¡** - é™æ€å’ŒåŠ¨æ€ä»£ç å®‰å…¨åˆ†æ
4. **åˆè§„æ£€æŸ¥** - å¯¹ç…§å®‰å…¨æ ‡å‡†å’Œæ³•è§„è¦æ±‚

### å®‰å…¨åŠ å›ºé˜¶æ®µ
1. **é˜²æŠ¤æªæ–½å®æ–½** - éƒ¨ç½²å®‰å…¨æ§ä»¶å’Œé˜²æŠ¤æœºåˆ¶
2. **å®‰å…¨é…ç½®** - ç³»ç»Ÿã€ç½‘ç»œã€åº”ç”¨å®‰å…¨é…ç½®
3. **ç›‘æ§å‘Šè­¦** - å»ºç«‹å®‰å…¨ç›‘æ§å’Œäº‹ä»¶å“åº”
4. **åŸ¹è®­å®£å¯¼** - å®‰å…¨æ„è¯†åŸ¹è®­å’Œæœ€ä½³å®è·µ

### æŒç»­æ”¹è¿›é˜¶æ®µ
1. **å®‰å…¨ç›‘æ§** - å®æ—¶å¨èƒæ£€æµ‹å’Œå“åº”
2. **æ¼æ´ç®¡ç†** - å®šæœŸæ‰«æã€è¯„ä¼°ã€ä¿®å¤æ¼æ´
3. **äº‹ä»¶å“åº”** - å®‰å…¨äº‹ä»¶å¤„ç†å’Œæ ¹å› åˆ†æ
4. **å®‰å…¨è¯„ä¼°** - å®šæœŸå®‰å…¨è¯„ä¼°å’Œæ”¹è¿›

## ğŸ› ï¸ å®‰å…¨å·¥å…·é“¾

### Webåº”ç”¨å®‰å…¨å·¥å…·
```typescript
// å®‰å…¨é…ç½®ç¤ºä¾‹
const securityConfig = {
  // CSPå†…å®¹å®‰å…¨ç­–ç•¥
  csp: {
    directives: {
      "default-src": ["'self'"],
      "script-src": ["'self'", "'unsafe-inline'"],
      "style-src": ["'self'", "'unsafe-inline'"],
      "img-src": ["'self'", "data:", "https:"],
      "connect-src": ["'self'"],
      "font-src": ["'self'"],
      "object-src": ["'none'"],
      "media-src": ["'self'"],
      "frame-src": ["'none'"],
    }
  },
  
  // HTTPSå®‰å…¨å¤´
  securityHeaders: {
    "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
    "X-Content-Type-Options": "nosniff",
    "X-Frame-Options": "DENY", 
    "X-XSS-Protection": "1; mode=block",
    "Referrer-Policy": "strict-origin-when-cross-origin",
    "Permissions-Policy": "camera=(), microphone=(), geolocation=()"
  },
  
  // Cookieå®‰å…¨è®¾ç½®
  cookie: {
    httpOnly: true,
    secure: true,
    sameSite: 'strict',
    maxAge: 3600000
  }
};

// è¾“å…¥éªŒè¯å’Œæ¸…ç†
class SecurityValidator {
  static sanitizeInput(input: string): string {
    return DOMPurify.sanitize(input, {
      ALLOWED_TAGS: ['b', 'i', 'em', 'strong'],
      ALLOWED_ATTR: []
    });
  }
  
  static validateSQL(query: string): boolean {
    const sqlInjectionPattern = /(\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|UNION)\b)/i;
    return !sqlInjectionPattern.test(query);
  }
  
  static validateFile(file: File): ValidationResult {
    const allowedTypes = ['image/jpeg', 'image/png', 'image/gif'];
    const maxSize = 5 * 1024 * 1024; // 5MB
    
    if (!allowedTypes.includes(file.type)) {
      return { valid: false, error: 'Invalid file type' };
    }
    
    if (file.size > maxSize) {
      return { valid: false, error: 'File too large' };
    }
    
    return { valid: true };
  }
}
```

### APIå®‰å…¨é˜²æŠ¤
```python
# APIå®‰å…¨ä¸­é—´ä»¶
import hashlib
import hmac
import jwt
from functools import wraps
from flask import request, jsonify, current_app

class APISecurityMiddleware:
    def __init__(self, app=None):
        self.app = app
        if app is not None:
            self.init_app(app)
    
    def init_app(self, app):
        app.config.setdefault('JWT_SECRET_KEY', 'your-secret-key')
        app.config.setdefault('API_RATE_LIMIT', '100/hour')
        
    # JWTè®¤è¯è£…é¥°å™¨
    def jwt_required(self, f):
        @wraps(f)
        def decorated_function(*args, **kwargs):
            token = request.headers.get('Authorization')
            if not token:
                return jsonify({'error': 'Missing token'}), 401
            
            try:
                token = token.replace('Bearer ', '')
                payload = jwt.decode(
                    token, 
                    current_app.config['JWT_SECRET_KEY'], 
                    algorithms=['HS256']
                )
                request.user = payload
            except jwt.ExpiredSignatureError:
                return jsonify({'error': 'Token expired'}), 401
            except jwt.InvalidTokenError:
                return jsonify({'error': 'Invalid token'}), 401
            
            return f(*args, **kwargs)
        return decorated_function
    
    # APIç­¾åéªŒè¯
    def verify_signature(self, f):
        @wraps(f)
        def decorated_function(*args, **kwargs):
            signature = request.headers.get('X-Signature')
            timestamp = request.headers.get('X-Timestamp')
            
            if not signature or not timestamp:
                return jsonify({'error': 'Missing signature'}), 401
            
            # éªŒè¯æ—¶é—´æˆ³(é˜²é‡æ”¾æ”»å‡»)
            if abs(int(timestamp) - int(time.time())) > 300:  # 5åˆ†é’Ÿ
                return jsonify({'error': 'Request expired'}), 401
            
            # è®¡ç®—ç­¾å
            message = f"{request.method}|{request.path}|{timestamp}|{request.get_data()}"
            expected_sig = hmac.new(
                current_app.config['API_SECRET'].encode(),
                message.encode(),
                hashlib.sha256
            ).hexdigest()
            
            if not hmac.compare_digest(signature, expected_sig):
                return jsonify({'error': 'Invalid signature'}), 401
            
            return f(*args, **kwargs)
        return decorated_function

# å‚æ•°éªŒè¯å’Œæ¸…ç†
from marshmallow import Schema, fields, validate

class UserSchema(Schema):
    username = fields.Str(
        required=True,
        validate=[
            validate.Length(min=3, max=50),
            validate.Regexp(r'^[a-zA-Z0-9_]+$')
        ]
    )
    email = fields.Email(required=True)
    password = fields.Str(
        required=True,
        validate=validate.Length(min=8),
        load_only=True
    )
    
    def validate_password_strength(self, value):
        if not re.search(r'[A-Z]', value):
            raise ValidationError('Password must contain uppercase letter')
        if not re.search(r'[a-z]', value):
            raise ValidationError('Password must contain lowercase letter')
        if not re.search(r'\d', value):
            raise ValidationError('Password must contain digit')
```

## ğŸ¯ å®‰å…¨é˜²æŠ¤æœ€ä½³å®è·µ

### è®¤è¯ä¸æˆæƒ
```typescript
// JWTå®‰å…¨å®ç°
class SecureJWT {
  private readonly secret: string;
  private readonly algorithm = 'HS256';
  
  constructor(secret: string) {
    this.secret = secret;
  }
  
  generateToken(payload: any, expiresIn: string = '1h'): string {
    return jwt.sign(
      {
        ...payload,
        iat: Math.floor(Date.now() / 1000),
        jti: uuidv4() // é˜²æ­¢é‡æ”¾æ”»å‡»
      },
      this.secret,
      { 
        algorithm: this.algorithm,
        expiresIn,
        issuer: 'your-app',
        audience: 'your-users'
      }
    );
  }
  
  verifyToken(token: string): any {
    try {
      return jwt.verify(token, this.secret, {
        algorithm: [this.algorithm],
        issuer: 'your-app',
        audience: 'your-users'
      });
    } catch (error) {
      throw new UnauthorizedError('Invalid token');
    }
  }
}

// RBACæƒé™æ§åˆ¶
class RBACManager {
  private roles: Map<string, Set<string>> = new Map();
  private userRoles: Map<string, Set<string>> = new Map();
  
  assignRole(userId: string, role: string): void {
    if (!this.userRoles.has(userId)) {
      this.userRoles.set(userId, new Set());
    }
    this.userRoles.get(userId)!.add(role);
  }
  
  hasPermission(userId: string, permission: string): boolean {
    const userRoles = this.userRoles.get(userId) || new Set();
    
    for (const role of userRoles) {
      const permissions = this.roles.get(role) || new Set();
      if (permissions.has(permission)) {
        return true;
      }
    }
    return false;
  }
  
  requirePermission(permission: string) {
    return (target: any, propertyKey: string, descriptor: PropertyDescriptor) => {
      const originalMethod = descriptor.value;
      
      descriptor.value = function(...args: any[]) {
        const userId = this.getCurrentUserId();
        if (!this.rbac.hasPermission(userId, permission)) {
          throw new ForbiddenError('Insufficient permissions');
        }
        return originalMethod.apply(this, args);
      };
    };
  }
}
```

### æ•°æ®åŠ å¯†å’Œä¿æŠ¤
```python
# æ•°æ®åŠ å¯†æœåŠ¡
from cryptography.fernet import Fernet
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC
import base64
import os

class DataEncryptionService:
    def __init__(self, password: bytes):
        # ç”Ÿæˆå¯†é’¥
        salt = os.urandom(16)
        kdf = PBKDF2HMAC(
            algorithm=hashes.SHA256(),
            length=32,
            salt=salt,
            iterations=100000,
        )
        key = base64.urlsafe_b64encode(kdf.derive(password))
        self.cipher = Fernet(key)
        self.salt = salt
    
    def encrypt_data(self, data: str) -> str:
        """åŠ å¯†æ•æ„Ÿæ•°æ®"""
        encrypted_data = self.cipher.encrypt(data.encode())
        return base64.urlsafe_b64encode(encrypted_data).decode()
    
    def decrypt_data(self, encrypted_data: str) -> str:
        """è§£å¯†æ•°æ®"""
        encrypted_bytes = base64.urlsafe_b64decode(encrypted_data.encode())
        decrypted_data = self.cipher.decrypt(encrypted_bytes)
        return decrypted_data.decode()
    
    def hash_password(self, password: str) -> str:
        """å¯†ç å“ˆå¸Œ"""
        import bcrypt
        return bcrypt.hashpw(password.encode(), bcrypt.gensalt()).decode()
    
    def verify_password(self, password: str, hashed: str) -> bool:
        """éªŒè¯å¯†ç """
        import bcrypt
        return bcrypt.checkpw(password.encode(), hashed.encode())

# æ•æ„Ÿæ•°æ®è„±æ•
class DataMasking:
    @staticmethod
    def mask_email(email: str) -> str:
        """é‚®ç®±è„±æ•"""
        if '@' not in email:
            return email
        local, domain = email.split('@')
        if len(local) <= 2:
            return email
        return f"{local[0]}***{local[-1]}@{domain}"
    
    @staticmethod
    def mask_phone(phone: str) -> str:
        """æ‰‹æœºå·è„±æ•"""
        if len(phone) != 11:
            return phone
        return f"{phone[:3]}****{phone[-4:]}"
    
    @staticmethod
    def mask_id_card(id_card: str) -> str:
        """èº«ä»½è¯è„±æ•"""
        if len(id_card) != 18:
            return id_card
        return f"{id_card[:4]}**********{id_card[-4:]}"
```

### å®‰å…¨ç›‘æ§å’Œå‘Šè­¦
```yaml
# å®‰å…¨ç›‘æ§é…ç½®
security_monitoring:
  # å…¥ä¾µæ£€æµ‹
  intrusion_detection:
    failed_login_threshold: 5
    failed_login_window: "15m"
    suspicious_ip_threshold: 100
    
  # å¼‚å¸¸è¡Œä¸ºæ£€æµ‹
  anomaly_detection:
    unusual_access_pattern: true
    privilege_escalation: true
    data_exfiltration: true
    
  # æ—¥å¿—ç›‘æ§
  log_monitoring:
    security_events:
      - authentication_failure
      - authorization_failure
      - privilege_change
      - sensitive_data_access
    
    alert_rules:
      - name: "Multiple Failed Logins"
        condition: "failed_login_count > 5 in 15m"
        severity: "medium"
        
      - name: "Privilege Escalation"
        condition: "privilege_change AND target_role = 'admin'"
        severity: "high"
        
      - name: "Suspicious File Access"
        condition: "file_access AND file_type = 'sensitive'"
        severity: "medium"

# Webåº”ç”¨é˜²ç«å¢™è§„åˆ™
waf_rules:
  # SQLæ³¨å…¥é˜²æŠ¤
  sql_injection:
    patterns:
      - "(?i)(union|select|insert|delete|update|drop|create|alter).*"
      - "(?i)(\"|'|`).*(or|and).*(\"|'|`)"
      - "(?i)(exec|execute|sp_executesql)"
    
  # XSSé˜²æŠ¤
  xss_protection:
    patterns:
      - "(?i)<script[^>]*>.*?</script>"
      - "(?i)javascript:[^\"]*"
      - "(?i)on(load|error|click|focus)=[^\\s]*"
    
  # æ–‡ä»¶åŒ…å«é˜²æŠ¤
  file_inclusion:
    patterns:
      - "(?i)\\.\\./.*"
      - "(?i)(etc/passwd|boot\\.ini)"
      - "(?i)file://.*"
```

## ğŸ’¡ å®‰å…¨äº‹ä»¶å“åº”

### äº‹ä»¶å“åº”æµç¨‹
1. **æ£€æµ‹è¯†åˆ«** - é€šè¿‡ç›‘æ§ç³»ç»Ÿå‘ç°å®‰å…¨äº‹ä»¶
2. **åˆæ­¥åˆ†æ** - ç¡®å®šäº‹ä»¶æ€§è´¨å’Œå½±å“èŒƒå›´
3. **éš”ç¦»éåˆ¶** - é˜»æ­¢äº‹ä»¶è¿›ä¸€æ­¥æ‰©æ•£
4. **æ·±å…¥è°ƒæŸ¥** - åˆ†ææ”»å‡»æ‰‹æ³•å’Œå½±å“è¯„ä¼°
5. **æ¢å¤å¤„ç†** - ä¿®å¤æ¼æ´ï¼Œæ¢å¤æ­£å¸¸æœåŠ¡
6. **æ€»ç»“æ”¹è¿›** - äº‹ååˆ†æï¼Œå®Œå–„é˜²æŠ¤æªæ–½

### å¸¸è§å®‰å…¨äº‹ä»¶å¤„ç†

#### SQLæ³¨å…¥æ”»å‡»
```bash
# åº”æ€¥å“åº”æ­¥éª¤
1. ç«‹å³æ–­å¼€æ•°æ®åº“è¿æ¥
2. æ£€æŸ¥æ•°æ®åº“æ—¥å¿—ï¼Œç¡®è®¤è¢«è®¿é—®çš„æ•°æ®
3. ä¿®å¤SQLæ³¨å…¥æ¼æ´
4. åŠ å¼ºè¾“å…¥éªŒè¯å’Œå‚æ•°åŒ–æŸ¥è¯¢
5. ç›‘æ§åç»­å¼‚å¸¸è®¿é—®

# é˜²æŠ¤åŠ å›º
- ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
- æœ€å°æƒé™åŸåˆ™
- æ•°æ®åº“é˜²ç«å¢™
- å®šæœŸå®‰å…¨æ‰«æ
```

#### DDoSæ”»å‡»
```bash
# åº”æ€¥å“åº”
1. å¯åŠ¨DDoSé˜²æŠ¤æœåŠ¡
2. åˆ†ææ”»å‡»ç‰¹å¾å’Œæ¥æº
3. é…ç½®æµé‡æ¸…æ´—è§„åˆ™
4. æ‰©å±•æœåŠ¡å™¨èµ„æº
5. è”ç³»ISPååŠ©é˜²æŠ¤

# é•¿æœŸé˜²æŠ¤
- CDNåŠ é€Ÿå’Œé˜²æŠ¤
- è´Ÿè½½å‡è¡¡å’Œå¼¹æ€§æ‰©å±•
- æµé‡ç›‘æ§å’Œå¼‚å¸¸å‘Šè­¦
- å»ºç«‹åº”æ€¥å“åº”é¢„æ¡ˆ
```

## ğŸ¯ åˆè§„å’Œè®¤è¯

### å®‰å…¨åˆè§„æ ‡å‡†
- **ISO 27001**: ä¿¡æ¯å®‰å…¨ç®¡ç†ä½“ç³»
- **SOC 2**: äº‘æœåŠ¡å®‰å…¨æ§åˆ¶
- **GDPR**: æ¬§ç›Ÿæ•°æ®ä¿æŠ¤æ³•è§„
- **HIPAA**: åŒ»ç–—ä¿¡æ¯ä¿æŠ¤æ³•æ¡ˆ
- **PCI DSS**: æ”¯ä»˜å¡è¡Œä¸šæ•°æ®å®‰å…¨æ ‡å‡†

### å®‰å…¨è®¤è¯æ¸…å•
- âœ… æ¼æ´æ‰«æå’Œæ¸—é€æµ‹è¯•
- âœ… ä»£ç å®‰å…¨å®¡è®¡
- âœ… å®‰å…¨é…ç½®åŸºçº¿æ£€æŸ¥
- âœ… æ•°æ®åŠ å¯†å’Œå¤‡ä»½éªŒè¯
- âœ… è®¿é—®æ§åˆ¶å’Œæƒé™å®¡æŸ¥
- âœ… å®‰å…¨ç›‘æ§å’Œæ—¥å¿—å®¡è®¡
- âœ… åº”æ€¥å“åº”è®¡åˆ’æµ‹è¯•
- âœ… å®‰å…¨åŸ¹è®­å’Œæ„è¯†æ•™è‚²

---

**ä½œä¸ºå®‰å…¨ä¸“å®¶ï¼Œæˆ‘è‡´åŠ›äºæ„å»ºå…¨é¢çš„å®‰å…¨é˜²æŠ¤ä½“ç³»ï¼Œé€šè¿‡æ·±åº¦é˜²å¾¡ç­–ç•¥ä¿æŠ¤åº”ç”¨å’Œæ•°æ®å®‰å…¨ã€‚æ— è®ºæ˜¯Webåº”ç”¨å®‰å…¨åŠ å›ºã€APIå®‰å…¨é˜²æŠ¤ï¼Œè¿˜æ˜¯åŸºç¡€è®¾æ–½å®‰å…¨ä¼˜åŒ–ï¼Œéƒ½èƒ½æä¾›ä¸“ä¸šçš„å®‰å…¨è§£å†³æ–¹æ¡ˆã€‚** ğŸ›¡ï¸